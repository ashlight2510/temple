<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>오늘의 마음 한 문장</title>

    <!-- SEO -->
    <meta
      name="description"
      content="불교 가르침에서 얻은 영감을 하루 한 문장으로 전합니다. 짧고 단단한 말들이 마음을 가볍게 돕습니다."
      data-i18n-content="metaDescription"
    />
    <meta
      name="keywords"
      content="오늘의 마음, 하루 한 문장, 불교, 명상, 마음공부, 영감 문장, 고요"
      data-i18n-content="metaKeywords"
    />
    <meta name="robots" content="index,follow" />
    <link rel="canonical" href="https://temple.funnyfunny.cloud/" />

    <!-- Open Graph (og-image text MUST be English) -->
    <meta property="og:title" content="Temple Wisdom" data-i18n-content="ogTitle" />
    <meta
      property="og:description"
      content="불교 가르침에서 얻은 영감을 하루 한 문장으로, 현대 한국어로 전합니다."
      data-i18n-content="ogDescription"
    />
    <meta
      property="og:image"
      content="https://dummyimage.com/1200x630/0b1220/ffffff&text=Temple+Wisdom"
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://temple.funnyfunny.cloud/" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Temple Wisdom" data-i18n-content="ogTitle" />
    <meta
      name="twitter:description"
      content="불교 가르침에서 얻은 영감을 하루 한 문장으로, 현대 한국어로 전합니다."
      data-i18n-content="ogDescription"
    />
    <meta
      name="twitter:image"
      content="https://dummyimage.com/1200x630/0b1220/ffffff&text=Temple+Wisdom"
    />

    <!-- Favicon (auto-generated SVG) -->
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0%25' y1='100%25' x2='100%25' y2='0%25'%3E%3Cstop offset='0%25' stop-color='%230b1220'/%3E%3Cstop offset='100%25' stop-color='%238b5cf6'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='64' height='64' rx='14' fill='url(%23g)'/%3E%3Cpath d='M18 26c6-8 22-8 28 0' fill='none' stroke='%23ddd6fe' stroke-width='2.5' stroke-linecap='round'/%3E%3Cpath d='M18 38c6 8 22 8 28 0' fill='none' stroke='%23ddd6fe' stroke-width='2.5' stroke-linecap='round'/%3E%3Ccircle cx='32' cy='32' r='4' fill='rgba(255,255,255,0.18)' stroke='%23e9d5ff' stroke-width='2'/%3E%3C/svg%3E"
    />

    <script src="https://cdn.tailwindcss.com"></script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1204894220949193"
     crossorigin="anonymous"></script>
    <!-- responsive-base -->
    <style>
      /* responsive-base */
      *, *::before, *::after {
        box-sizing: border-box;
      }
      html {
        -webkit-text-size-adjust: 100%;
      }
      img,
      video,
      canvas,
      svg {
        max-width: 100%;
        height: auto;
      }
      table {
        width: 100%;
      }
      pre,
      code {
        white-space: pre-wrap;
        word-break: break-word;
      }
    </style>
  <style>
    .adsense-block {
      margin: 16px 0;
      display: flex;
      justify-content: center;
    }
    .adsbygoogle {
      display: block;
      margin: 16px auto;
        text-align: center;
}
  </style>
  <style>
    .lang-switch {
      display: inline-flex;
      gap: 6px;
      padding: 4px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.16);
    }
    .lang-switch button {
      border: none;
      background: transparent;
      color: rgba(255, 255, 255, 0.7);
      font-size: 12px;
      font-weight: 700;
      padding: 6px 12px;
      border-radius: 999px;
      cursor: pointer;
      letter-spacing: 0.08em;
    }
    .lang-switch button.active {
      background: #8b5cf6;
      color: #0b1120;
    }
  </style>
</head>

  <body
    class="min-h-screen bg-gradient-to-b from-slate-950 to-slate-900 text-white"
  ><main class="max-w-3xl mx-auto px-4 py-10">
      <div class="flex items-center justify-between mb-4 gap-3">
        <div class="lang-switch" role="tablist" aria-label="Language switcher">
          <button type="button" data-lang="ko" class="active">한국어</button>
          <button type="button" data-lang="en">English</button>
        </div>
        <a
          href="https://funnyfunny.cloud/"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/15 border border-white/15 text-white rounded-lg font-medium transition-colors duration-200"
          data-i18n="viewMore"
        >
          다른 서비스 보기
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="w-4 h-4"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M17 7h-6m6 0-5.5 5.5M17 7v6"></path>
            <path d="M7 7v10h10"></path>
          </svg>
        </a>
      </div>

      <!-- Header -->
      <header class="text-center mb-8">
        <div
          class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/5 border border-white/10"
        >
          <span
            class="text-violet-300 text-sm font-semibold"
            data-i18n="badgeTitle"
            >오늘의 마음</span
          >
          <span class="text-white/50 text-sm">Temple Wisdom</span>
        </div>
        <h1
          class="mt-4 text-3xl md:text-4xl font-extrabold tracking-tight"
          data-i18n="heroTitle"
        >
          하루 한 문장
        </h1>
        <p class="mt-2 text-white/70" data-i18n="heroSubtitle">
          불교 가르침을 오늘의 언어로 풀어낸 하루 한 문장
        </p>
      </header>

      <!-- Today Card -->
      <section
        class="rounded-2xl bg-white/5 border border-white/10 p-6 shadow-lg"
      >
        <div class="flex items-start justify-between gap-4">
          <div class="min-w-0">
            <p class="text-sm text-white/60" data-i18n="todayLabel">
              오늘의 문장
            </p>
            <p
              id="todayText"
              class="mt-2 text-xl md:text-2xl font-bold leading-relaxed"
            ></p>
            <div class="mt-3 flex flex-wrap items-center gap-2">
              <span
                id="todayTheme"
                class="text-xs px-2 py-1 rounded-full bg-violet-500/15 text-violet-200 border border-violet-500/20"
              ></span>
              <span
                class="text-xs px-2 py-1 rounded-full bg-white/5 text-white/60 border border-white/10"
                data-i18n="todayNote"
              >
                직접 인용 없이 새로 쓴 문장
              </span>
            </div>
          </div>
        </div>

        <div class="mt-5 grid grid-cols-1 md:grid-cols-3 gap-3">
          <div class="rounded-xl bg-black/20 border border-white/10 p-4">
            <p class="text-xs text-white/50" data-i18n="updateLabel">
              업데이트
            </p>
            <p id="todayDate" class="mt-1 font-semibold"></p>
          </div>
          <div class="rounded-xl bg-black/20 border border-white/10 p-4">
            <p class="text-xs text-white/50" data-i18n="countLabel">문장 수</p>
            <p class="mt-1 font-semibold">
              <span id="countText"></span><span data-i18n="countSuffix">개</span>
            </p>
          </div>
          <div class="rounded-xl bg-black/20 border border-white/10 p-4">
            <p class="text-xs text-white/50" data-i18n="ruleLabel">
              랜덤 규칙
            </p>
            <p class="mt-1 font-semibold" data-i18n="ruleValue">날짜별 고정</p>
          </div>
        </div>

        <div
          class="mt-5 flex flex-col gap-3 md:flex-row md:items-center md:justify-between"
        >
          <div class="flex flex-wrap gap-2">
            <button
              id="copyTodayBtn"
              class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-violet-500 hover:bg-violet-400 text-slate-950 font-semibold transition-colors"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-4 h-4"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M8 4h10a2 2 0 0 1 2 2v10"></path>
                <rect x="4" y="8" width="14" height="14" rx="2"></rect>
              </svg>
              <span data-i18n="copyButton">복사</span>
            </button>

            <button
              id="shareTodayBtn"
              class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-white/10 hover:bg-white/15 border border-white/10 text-white font-semibold transition-colors"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-4 h-4"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="5" r="3"></circle>
                <circle cx="5" cy="19" r="3"></circle>
                <circle cx="19" cy="19" r="3"></circle>
                <path d="M8.59 17.51 15.42 13M8.59 6.49l6.83 4.02"></path>
              </svg>
              <span data-i18n="shareButton">공유하기</span>
            </button>
          </div>

          <p class="text-xs text-white/50 leading-snug" data-i18n="shareHint">
            공유 시 오늘의 문장과 서비스 링크, 출처가 함께 전달됩니다.
          </p>
        </div>
      </section>

      <!-- Controls -->
      <section class="mt-8 rounded-2xl bg-white/5 border border-white/10 p-6">
        <div class="flex flex-col md:flex-row md:items-end gap-4">
          <label class="flex-1">
            <span class="block text-sm text-white/70" data-i18n="searchLabel">
              검색
            </span>
            <input
              id="q"
              type="text"
              placeholder="예: 집착, 내려놓음, 자비, 호흡, 고요..."
              data-i18n-placeholder="searchPlaceholder"
              class="mt-2 w-full rounded-xl bg-black/20 border border-white/10 px-4 py-3 outline-none focus:ring-2 focus:ring-violet-500/60 placeholder:text-white/40"
            />
          </label>

          <label class="md:w-56">
            <span class="block text-sm text-white/70" data-i18n="themeLabel">
              테마
            </span>
            <select
              id="theme"
              class="mt-2 w-full rounded-xl bg-black/20 border border-white/10 px-4 py-3 outline-none focus:ring-2 focus:ring-violet-500/60"
            >
              <option value="" data-i18n="themeAll">전체</option>
            </select>
          </label>

          <div class="flex gap-3 md:w-auto">
            <button
              id="shuffleBtn"
              class="w-full md:w-auto px-4 py-3 rounded-xl bg-white/10 hover:bg-white/15 border border-white/10 text-white font-semibold transition-colors"
              data-i18n="shuffleButton"
            >
              오늘 다시 뽑기
            </button>
            <button
              id="downloadBtn"
              class="w-full md:w-auto px-4 py-3 rounded-xl bg-white/10 hover:bg-white/15 border border-white/10 text-white font-semibold transition-colors"
              data-i18n="downloadButton"
            >
              1000문장 TXT 받기
            </button>
          </div>
        </div>

        <p class="mt-4 text-sm text-white/50" data-i18n="note">
          ※ 불경 번역문을 인용하지 않으며, 가르침에서 얻은 영감으로 새로 쓴
          문장만 제공합니다.
        </p>
      </section>

      <!-- List -->
      <section class="mt-6">
        <div class="flex items-center justify-between mb-3">
          <h2 class="text-lg font-bold" data-i18n="listTitle">문장 모음</h2>
          <div class="text-sm text-white/60">
            <span id="resultCount"></span>
          </div>
        </div>

        <div id="list" class="grid grid-cols-1 gap-3"></div>

        <!-- Pagination -->
        <div class="mt-6 flex items-center justify-between">
          <button
            id="prevBtn"
            class="px-4 py-2 rounded-xl bg-white/10 hover:bg-white/15 border border-white/10 disabled:opacity-40 disabled:hover:bg-white/10 transition-colors"
            data-i18n="prevButton"
          >
            이전
          </button>
          <div class="text-sm text-white/60">
            <span id="pageInfo"></span>
          </div>
          <button
            id="nextBtn"
            class="px-4 py-2 rounded-xl bg-white/10 hover:bg-white/15 border border-white/10 disabled:opacity-40 disabled:hover:bg-white/10 transition-colors"
            data-i18n="nextButton"
          >
            다음
          </button>
        </div>
      </section>

      <!-- Other services button (your style) -->
      <footer class="mt-6 text-center text-xs text-white/40">
        © <span id="year"></span> Temple Wisdom
      </footer>
    </main>

    <script>
      const translations = {
        ko: {
          metaTitle: "오늘의 마음 한 문장",
          metaDescription: "불교 가르침에서 얻은 영감을 하루 한 문장으로 전합니다. 짧고 단단한 말들이 마음을 가볍게 돕습니다.",
          metaKeywords: "오늘의 마음, 하루 한 문장, 불교, 명상, 마음공부, 영감 문장, 고요",
          ogTitle: "Temple Wisdom",
          ogDescription: "불교 가르침에서 얻은 영감을 하루 한 문장으로, 현대 한국어로 전합니다.",
          viewMore: "다른 서비스 보기",
          badgeTitle: "오늘의 마음",
          heroTitle: "하루 한 문장",
          heroSubtitle: "불교 가르침을 오늘의 언어로 풀어낸 하루 한 문장",
          todayLabel: "오늘의 문장",
          todayNote: "직접 인용 없이 새로 쓴 문장",
          updateLabel: "업데이트",
          countLabel: "문장 수",
          countSuffix: "개",
          ruleLabel: "랜덤 규칙",
          ruleValue: "날짜별 고정",
          copyButton: "복사",
          copyDone: "복사됨",
          shareButton: "공유하기",
          shareDone: "공유됨",
          linkCopied: "링크 복사됨",
          shareHint: "공유 시 오늘의 문장과 서비스 링크, 출처가 함께 전달됩니다.",
          note:
            "※ 불경 번역문을 인용하지 않으며, 가르침에서 얻은 영감으로 새로 쓴 문장만 제공합니다.",
          listTitle: "문장 모음",
          prevButton: "이전",
          nextButton: "다음",
          searchLabel: "검색",
          searchPlaceholder: "예: 집착, 내려놓음, 자비, 호흡, 고요...",
          themeLabel: "테마",
          themeAll: "전체",
          shuffleButton: "오늘 다시 뽑기",
          downloadButton: "1000문장 TXT 받기",
          resultCount: "{count}개 결과",
          pageInfo: "{page} / {total}",
          themePrefix: "테마: {theme}",
          shareMessage:
            "오늘의 마음에서 더 보기: https://temple.funnyfunny.cloud/\n출처: 오늘의 마음",
          serviceTag: " - 오늘의 마음",
          loadFail: "문장을 불러오지 못했습니다.",
          downloadFilename: "temple_wisdom_1000.txt",
        },
        en: {
          metaTitle: "Temple Wisdom - One Line a Day",
          metaDescription: "A daily line inspired by Buddhist teachings, rewritten for today. Short and solid words that help lighten the mind.",
          metaKeywords: "temple wisdom, one line a day, buddhism, meditation, mindfulness, inspiration, calm",
          ogTitle: "Temple Wisdom",
          ogDescription: "A daily line inspired by Buddhist teachings, rewritten in modern language.",
          viewMore: "View other services",
          badgeTitle: "Mind of the Day",
          heroTitle: "One Line a Day",
          heroSubtitle:
            "A daily line inspired by Buddhist teachings, rewritten for today.",
          todayLabel: "Today's line",
          todayNote: "Original line inspired by teachings",
          updateLabel: "Updated",
          countLabel: "Total lines",
          countSuffix: "",
          ruleLabel: "Random rule",
          ruleValue: "Fixed by date",
          copyButton: "Copy",
          copyDone: "Copied",
          shareButton: "Share",
          shareDone: "Shared",
          linkCopied: "Link copied",
          shareHint: "Sharing includes today's line, link, and source.",
          note:
            "※ We do not quote scripture translations. All lines are newly written from inspired teachings.",
          listTitle: "All lines",
          prevButton: "Prev",
          nextButton: "Next",
          searchLabel: "Search",
          searchPlaceholder: "e.g., letting go, compassion, breath, calm...",
          themeLabel: "Theme",
          themeAll: "All",
          shuffleButton: "Draw again",
          downloadButton: "Download 1000 lines TXT",
          resultCount: "{count} results",
          pageInfo: "{page} / {total}",
          themePrefix: "Theme: {theme}",
          shareMessage:
            "See more at Temple Wisdom: https://temple.funnyfunny.cloud/\nSource: Temple Wisdom",
          serviceTag: " - Temple Wisdom",
          loadFail: "Failed to load sentences.",
          downloadFilename: "temple_wisdom_1000.txt",
        },
      };

      const DATA_URL = "all_sentences.json";
      const $ = (id) => document.getElementById(id);
      const copyBtnIcon =
        $("copyTodayBtn")?.querySelector("svg")?.outerHTML || "";
      const shareBtnIcon =
        $("shareTodayBtn")?.querySelector("svg")?.outerHTML || "";

      const defaultLang = "ko";
      const supportedLangs = ["ko", "en"];
      let currentLang = defaultLang;

      function getPack() {
        return translations[currentLang] || translations.ko;
      }

      function t(key, vars = {}) {
        const pack = getPack();
        const template = pack[key] ?? translations.ko[key] ?? key;
        if (typeof template !== "string") return template;
        return template.replace(/\{(\w+)\}/g, (_, token) =>
          vars[token] !== undefined ? vars[token] : `{${token}}`
        );
      }

      function formatDate(date) {
        if (currentLang === "en") {
          return new Intl.DateTimeFormat("en-US", {
            year: "numeric",
            month: "short",
            day: "numeric",
          }).format(date);
        }
        const y = date.getFullYear();
        const m = String(date.getMonth() + 1).padStart(2, "0");
        const d = String(date.getDate()).padStart(2, "0");
        return `${y}.${m}.${d}`;
      }

      async function copyText(text) {
        try {
          await navigator.clipboard.writeText(text);
          return true;
        } catch (_) {
          const ta = document.createElement("textarea");
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          try {
            document.execCommand("copy");
          } catch (e) {}
          document.body.removeChild(ta);
          return true;
        }
      }

      function escapeHtml(str) {
        return str
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;")
          .replaceAll('"', "&quot;")
          .replaceAll("'", "&#039;");
      }

      function dailyIndex(date, mod) {
        const y = date.getFullYear();
        const m = date.getMonth() + 1;
        const d = date.getDate();
        let x = (y * 10000 + m * 100 + d) >>> 0;
        x = (x ^ 0x9e3779b9) >>> 0;
        x = Math.imul(x ^ (x >>> 16), 0x85ebca6b) >>> 0;
        x = Math.imul(x ^ (x >>> 13), 0xc2b2ae35) >>> 0;
        x = (x ^ (x >>> 16)) >>> 0;
        return x % mod;
      }

      function formatCopyText(text) {
        return `${text}${t("serviceTag")}`;
      }

      let ALL = [];
      let filtered = [];
      let page = 1;
      const pageSize = 20;
      let todayItem = null;
      function renderCopyBtn() {
        $("copyTodayBtn").innerHTML = `${copyBtnIcon}<span>${t(
          "copyButton"
        )}</span>`;
      }

      function renderShareBtn() {
        $("shareTodayBtn").innerHTML = `${shareBtnIcon}<span>${t(
          "shareButton"
        )}</span>`;
      }

      // 테마 이름 번역 매핑
      const themeTranslations = {
        ko: {
          "고요": "고요",
          "호흡": "호흡",
          "집착 내려놓기": "집착 내려놓기",
          "자비": "자비",
          "연민": "연민",
          "마음챙김": "마음챙김",
          "분노 다루기": "분노 다루기",
          "욕심 다루기": "욕심 다루기",
          "불안 다루기": "불안 다루기",
          "말과 침묵": "말과 침묵",
          "관계": "관계",
          "인내": "인내",
          "절제": "절제",
          "겸손": "겸손",
          "감사": "감사",
          "균형": "균형",
          "현재": "현재",
          "행동": "행동",
          "습관": "습관",
          "지혜": "지혜",
          "무상": "무상",
          "연기": "연기",
          "현재": "현재",
        },
        en: {
          "고요": "Calm",
          "호흡": "Breath",
          "집착 내려놓기": "Letting Go",
          "자비": "Compassion",
          "연민": "Empathy",
          "마음챙김": "Mindfulness",
          "분노 다루기": "Managing Anger",
          "욕심 다루기": "Managing Greed",
          "불안 다루기": "Managing Anxiety",
          "말과 침묵": "Words and Silence",
          "관계": "Relationships",
          "인내": "Patience",
          "절제": "Restraint",
          "겸손": "Humility",
          "감사": "Gratitude",
          "균형": "Balance",
          "현재": "Present",
          "행동": "Action",
          "습관": "Habits",
          "지혜": "Wisdom",
          "무상": "Impermanence",
          "연기": "Dependent Origination",
        },
      };

      function translateTheme(theme) {
        return themeTranslations[currentLang]?.[theme] || theme;
      }

      function renderThemes() {
        const sel = $("theme");
        if (!sel) return;
        sel.innerHTML = `<option value="">${t("themeAll")}</option>`;
        const uniq = [...new Set(ALL.map((x) => x.theme))];
        uniq.forEach((theme) => {
          const opt = document.createElement("option");
          opt.value = theme;
          opt.textContent = translateTheme(theme);
          sel.appendChild(opt);
        });
      }

      function setToday(forceRandom = false) {
        if (!ALL.length) return;
        const now = new Date();
        const idx = forceRandom
          ? Math.floor(Math.random() * ALL.length)
          : dailyIndex(now, ALL.length);
        const item = ALL[idx];

        todayItem = item;
        const displayText = currentLang === "en" && item.text_en ? item.text_en : item.text;
        $("todayText").textContent = displayText;
        $("todayTheme").textContent = t("themePrefix", { theme: translateTheme(item.theme) });
        $("todayDate").textContent = formatDate(now);

        $("copyTodayBtn").onclick = async () => {
          const displayText = currentLang === "en" && item.text_en ? item.text_en : item.text;
          const ok = await copyText(formatCopyText(displayText));
          if (ok) {
            $("copyTodayBtn").textContent = t("copyDone");
            setTimeout(() => {
              renderCopyBtn();
            }, 900);
          }
        };
      }

      async function shareToday() {
        if (!todayItem) return;
        const btn = $("shareTodayBtn");
        const displayText = currentLang === "en" && todayItem.text_en ? todayItem.text_en : todayItem.text;
        const message = `${displayText}\n\n${t("shareMessage")}`;

        try {
          if (navigator.share) {
            await navigator.share({
              title: t("badgeTitle"),
              text: message,
              url: "https://temple.funnyfunny.cloud/",
            });
            btn.textContent = t("shareDone");
          } else {
            await copyText(message);
            btn.textContent = t("linkCopied");
          }
        } catch (_) {
          await copyText(message);
          btn.textContent = t("linkCopied");
        }

        setTimeout(() => {
          renderShareBtn();
        }, 1000);
      }

      function applyFilter() {
        if (!ALL.length) return;
        const q = $("q").value.trim();
        const th = $("theme").value;

        filtered = ALL.filter((item) => {
          const okTheme = !th || item.theme === th;
          const translatedTheme = translateTheme(item.theme);
          const okQ = !q || item.text.includes(q) || item.theme.includes(q) || translatedTheme.toLowerCase().includes(q.toLowerCase());
          return okTheme && okQ;
        });

        page = 1;
        renderList();
      }

      function renderList() {
        const start = (page - 1) * pageSize;
        const items = filtered.slice(start, start + pageSize);

        const list = $("list");
        list.innerHTML = "";

        items.forEach((item) => {
          const card = document.createElement("div");
          card.className =
            "rounded-2xl bg-white/5 border border-white/10 p-5 hover:border-violet-400/40 transition-colors";

          card.innerHTML = `
            <div class="flex items-start justify-between gap-4">
              <div class="min-w-0">
                <div class="flex flex-wrap items-center gap-2">
                  <span class="text-xs px-2 py-1 rounded-full bg-white/5 text-white/60 border border-white/10">#${
                    item.id
                  }</span>
                  <span class="text-xs px-2 py-1 rounded-full bg-violet-500/15 text-violet-200 border border-violet-500/20">${translateTheme(
                    item.theme
                  )}</span>
                </div>
                <p class="mt-3 text-base md:text-lg font-semibold leading-relaxed">${escapeHtml(
                  (currentLang === "en" && item.text_en) ? item.text_en : item.text
                )}</p>
              </div>
              <button class="copyBtn shrink-0 px-3 py-2 rounded-xl bg-white/10 hover:bg-white/15 border border-white/10 text-sm font-semibold transition-colors">
                ${t("copyButton")}
              </button>
            </div>
          `;

          const btn = card.querySelector(".copyBtn");
          btn.addEventListener("click", async () => {
            const displayText = currentLang === "en" && item.text_en ? item.text_en : item.text;
            const copyTextWithUrl = `${formatCopyText(
              displayText
            )} https://temple.funnyfunny.cloud/`;
            const ok = await copyText(copyTextWithUrl);
            if (ok) {
              btn.textContent = t("copyDone");
              setTimeout(() => (btn.textContent = t("copyButton")), 900);
            }
          });

          list.appendChild(card);
        });

        const totalPages = Math.max(1, Math.ceil(filtered.length / pageSize));
        $("prevBtn").disabled = page <= 1;
        $("nextBtn").disabled = page >= totalPages;
        $("pageInfo").textContent = t("pageInfo", {
          page,
          total: totalPages,
        });
        $("resultCount").textContent = t("resultCount", {
          count: filtered.length,
        });
      }

      function downloadTxt() {
        const lines = ALL.map((x) => `[${x.id}] (${x.theme}) ${x.text}`);
        const blob = new Blob([lines.join("\n")], {
          type: "text/plain;charset=utf-8",
        });
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = t("downloadFilename");
        a.click();
      }

      function applyTranslations() {
        document.title = t("metaTitle");
        document.documentElement.lang = currentLang;
        
        // Update meta tags
        document.querySelectorAll("[data-i18n-content]").forEach((el) => {
          el.setAttribute("content", t(el.dataset.i18nContent));
        });
        
        document.querySelectorAll("[data-i18n]").forEach((el) => {
          el.textContent = t(el.dataset.i18n);
        });
        document.querySelectorAll("[data-i18n-placeholder]").forEach((el) => {
          el.setAttribute("placeholder", t(el.dataset.i18nPlaceholder));
        });
        
        // Update theme select first option
        const themeSelect = $("theme");
        if (themeSelect && themeSelect.firstElementChild) {
          themeSelect.firstElementChild.textContent = t("themeAll");
        }
        
        renderCopyBtn();
        renderShareBtn();
      }

      function setLang(lang, options = {}) {
        const nextLang = translations[lang] ? lang : defaultLang;
        currentLang = nextLang;
        window.currentLang = currentLang;
        document.documentElement.lang = nextLang;
        localStorage.setItem("preferredLang", nextLang);
        document.querySelectorAll(".lang-switch button").forEach((button) => {
          button.classList.toggle("active", button.dataset.lang === nextLang);
        });
        const prevTheme = $("theme")?.value || "";
        applyTranslations();
        renderThemes();
        if (prevTheme) {
          $("theme").value = prevTheme;
        }
        // Update today's quote with new language
        if (todayItem) {
          const displayText = currentLang === "en" && todayItem.text_en ? todayItem.text_en : todayItem.text;
          $("todayText").textContent = displayText;
          $("todayTheme").textContent = t("themePrefix", {
            theme: translateTheme(todayItem.theme),
          });
          $("todayDate").textContent = formatDate(new Date());
        }
        renderList();
        if (options.updateUrl) {
          const url = new URL(window.location.href);
          url.searchParams.set("lang", nextLang);
          window.history.replaceState({}, "", url);
        }
      }

      function detectLang() {
        const params = new URLSearchParams(window.location.search);
        const paramLang = params.get("lang");
        if (supportedLangs.includes(paramLang)) return paramLang;
        const stored = localStorage.getItem("preferredLang");
        if (supportedLangs.includes(stored)) return stored;
        const browserLang =
          navigator.languages && navigator.languages.length
            ? navigator.languages[0]
            : navigator.language;
        if (browserLang && browserLang.toLowerCase().startsWith("ko")) {
          return "ko";
        }
        return defaultLang;
      }

      async function boot() {
        $("year").textContent = new Date().getFullYear();

        try {
          const res = await fetch(DATA_URL);
          ALL = await res.json();
        } catch (err) {
          console.error(t("loadFail"), err);
          return;
        }

        $("countText").textContent = ALL.length;
        renderThemes();
        setToday(false);
        applyFilter();

        $("q").addEventListener("input", applyFilter);
        $("theme").addEventListener("change", applyFilter);

        $("prevBtn").addEventListener("click", () => {
          page--;
          renderList();
        });
        $("nextBtn").addEventListener("click", () => {
          page++;
          renderList();
        });

        $("shuffleBtn").addEventListener("click", () => setToday(true));
        $("downloadBtn").addEventListener("click", downloadTxt);
        $("shareTodayBtn").addEventListener("click", shareToday);
      }

      document.querySelectorAll(".lang-switch button").forEach((button) => {
        button.addEventListener("click", () => {
          setLang(button.dataset.lang, { updateUrl: true });
        });
      });

      setLang(detectLang(), { updateUrl: false });
      boot();
    </script>
  
<ins class="adsbygoogle"
     style="display:block; text-align:center"
     data-ad-client="ca-pub-1204894220949193"
     data-ad-slot="5145068706"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
    
</body>
</html>
